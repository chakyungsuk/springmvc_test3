<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
				   
<mapper namespace="com.junefw.infra.modules.member.MemberMpp">

    <resultMap id="resultMapObj" type="com.junefw.infra.modules.member.Member"></resultMap>

	<select id="selectOneMember" resultType="Integer">
		SELECT 
			count(*)
		FROM
			fdmember a
		LEFT JOIN fdmemberemail b on b.ifmmSeq = a.ifmmSeq
		LEFT JOIN fdmemberphone c on c.ifmmSeq = a.ifmmSeq
		WHERE 1=1
			AND ifmmDelNy = 0
	</select>
	
	
	<select id="selectList" resultMap="resultMapObj">
		SELECT
			a.ifmmSeq
			, a.ifmmId
			, a.ifmmPassword
			, a.ifmmDelNy
			, a.ifmmSaved
			, b.fdmeEmailFull
			, concat(substring(c.fdmpNumber,1,3),"-",substring(c.fdmpNumber,4,4),"-",substring(c.fdmpNumber,7,4)) as mobile
		FROM
			fdmember a
		LEFT JOIN fdmemberemail b on b.ifmmSeq = a.ifmmSeq
		LEFT JOIN fdmemberphone c on c.ifmmSeq = a.ifmmSeq
		WHERE 1=1
			AND ifmmDelNy = 0
		LIMIT #{startRnumForMysql},#{rowNumToShow}
	</select>
	
	
	<insert id="insert">
		insert into fdMember(
			ifmmId
			, ifmmPassword
			, ifmmDelNy
			, ifmmSaved
		) values (
			#{ifmmId}
			, #{ifmmPassword}
			, 0
			, 1
		)
	</insert>
	
	<select id="selectOne" resultMap="resultMapObj">
		SELECT 
			a.ifmmSeq
			, a.ifmmId
			, a.ifmmPassword
			, a.ifmmSaved
			, a.ifmmDelNy
		FROM
			fdmember a
		WHERE 1=1
			and ifmmSeq = #{ifmmSeq}
	</select>
	
	<update id="update">
		UPDATE 
			fdmember
		SET
			ifmmId = #{ifmmId}
			, ifmmPassword = #{ifmmPassword}
		WHERE 1=1
			AND ifmmSeq = #{ifmmSeq}
	</update>
</mapper>